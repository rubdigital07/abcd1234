<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Xin lỗi công chúa 💖</title>
<style>
  body { margin:0; font-family:sans-serif; background:linear-gradient(135deg,#fbcfe8,#e0f2fe); overflow:hidden; }
  section { display:none; height:100vh; width:100vw; align-items:center; justify-content:center; flex-direction:column; text-align:center; }
  section.active { display:flex; }
  h1 { color:#be185d; font-size:clamp(22px,4vw,36px); margin-bottom:20px; animation:pulse 2.5s infinite; }
  @keyframes pulse {0%,100%{transform:scale(1)}50%{transform:scale(1.05)}}
  .btn { padding:14px 24px; font-size:16px; border:0; border-radius:12px; color:#fff; cursor:pointer; margin:10px; box-shadow:0 8px 24px rgba(0,0,0,.18);}
  #noBtn { background:#2563eb; position:absolute; }
  #yesBtn,#nextBtn,#quizBtn,#finalBtn { background:linear-gradient(45deg,#f43f5e,#ec4899,#a855f7); background-size:300% 300%; animation:gradient 6s ease infinite; }
  @keyframes gradient{0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%}}
  .heart { position:fixed; font-size:22px; animation:floatUp 2.5s forwards; pointer-events:none;}
  @keyframes floatUp{0%{transform:translateY(0) scale(1);opacity:1}100%{transform:translateY(-150px) scale(1.8);opacity:0}}
  .chat { display:none; position:fixed; bottom:100px; right:20px; background:#fff; border-radius:12px; padding:12px 16px; box-shadow:0 4px 20px rgba(0,0,0,.15);}
  canvas{position:fixed;top:0;left:0;pointer-events:none;}
</style>
</head>
<body>
  <!-- Giai đoạn 1 -->
  <section id="s1" class="active">
    <h1>Em có điều muốn nói…</h1>
    <button id="nextBtn" class="btn">Bắt đầu</button>
  </section>

  <!-- Giai đoạn 2 -->
  <section id="s2">
    <h1>Công chúa ơi, hết dỗi nha 😢</h1>
    <button id="noBtn" class="btn">Không tha thứ 😠</button>
    <button id="yesBtn" class="btn">Có thể tha thứ</button>
  </section>

  <!-- Giai đoạn 3 -->
  <section id="s3">
    <h1>Chị sẽ hết dỗi trong bao lâu nữa? 💕</h1>
    <button class="btn quiz" data-ok="false">A. Còn lâu nha</button>
    <button class="btn quiz" data-ok="false">B. Chắc là mai</button>
    <button class="btn quiz" data-ok="true">C. Ngay bây giờ 🌊</button>
  </section>

  <!-- Giai đoạn 4 -->
  <section id="s4">
    <h1>Đúng rồi! Cảm ơn vì công chúa đã hết dỗi nha 💖</h1>
    <button id="finalBtn" class="btn">Tha thứ thật rồi 💖</button>
    <canvas id="confetti"></canvas>
  </section>

  <!-- Giai đoạn 5 -->
  <section id="s5">
    <h1>Yay! Xác nhận đã hết dỗi 💖</h1>
    <div id="chat" class="chat">Mình huề nha, Iu chị Tú nhất HCM 💕</div>
  </section>

<script>
  const s1=document.getElementById("s1"),s2=document.getElementById("s2"),s3=document.getElementById("s3"),s4=document.getElementById("s4"),s5=document.getElementById("s5");
  const noBtn=document.getElementById("noBtn"),yesBtn=document.getElementById("yesBtn"),nextBtn=document.getElementById("nextBtn"),finalBtn=document.getElementById("finalBtn");
  const chat=document.getElementById("chat");

  const PAD=20;
  function randomPos(){
    const x=PAD+Math.random()*(window.innerWidth-noBtn.offsetWidth-2*PAD);
    const y=PAD+Math.random()*(window.innerHeight-noBtn.offsetHeight-2*PAD);
    noBtn.style.left=x+"px"; noBtn.style.top=y+"px";
  }
  randomPos();
  noBtn.addEventListener("pointerenter",randomPos);

  nextBtn.onclick=()=>{s1.classList.remove("active");s2.classList.add("active");}
  yesBtn.onclick=()=>{s2.classList.remove("active");s3.classList.add("active");}
  document.querySelectorAll(".quiz").forEach(btn=>{
    btn.onclick=()=>{
      if(btn.dataset.ok==="true"){s3.classList.remove("active");s4.classList.add("active");startConfetti();for(let i=0;i<12;i++)setTimeout(spawnHeart,i*120);}
      else alert("Sai rồi 😝 thử lại đi!");
    }
  });
  finalBtn.onclick=()=>{s4.classList.remove("active");s5.classList.add("active");chat.style.display="block";}

  function spawnHeart(){
    const h=document.createElement("div");
    h.className="heart";h.innerText="💖";
    h.style.left=(window.innerWidth/2+(Math.random()*120-60))+"px";
    h.style.top=(window.innerHeight-80)+"px";
    document.body.appendChild(h);setTimeout(()=>h.remove(),2500);
  }

  // Confetti
  const canvas=document.getElementById("confetti"),ctx=canvas.getContext("2d");
  let W,H,confettis=[];
  function resize(){W=canvas.width=window.innerWidth;H=canvas.height=window.innerHeight}
  resize();window.addEventListener("resize",resize);
  function Confetti(){this.x=Math.random()*W;this.y=Math.random()*H-H;this.size=8+Math.random()*4;this.speed=2+Math.random()*3;this.color=`hsl(${Math.random()*360},100%,50%)`;}
  function startConfetti(){confettis=Array.from({length:150},()=>new Confetti());animate();}
  function animate(){ctx.clearRect(0,0,W,H);confettis.forEach(c=>{ctx.fillStyle=c.color;ctx.fillRect(c.x,c.y,c.size,c.size);c.y+=c.speed;if(c.y>H) c.y=-10;});requestAnimationFrame(animate);}
</script>
</body>
</html>
